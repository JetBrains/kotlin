flowchart TD
    classDef nowrapClass text-align:center,white-space:nowrap;
    classDef callStyle fill:#f2debb,stroke:#333,stroke-width:4px;
    classDef candidateStyle fill:#f2e5ce,stroke:#333,stroke-width:4px;
    classDef stageStyle fill:#c8f0f7,stroke:#333,stroke-width:4px;
    classDef readinessStyle fill:#fff4d6,stroke:#777,stroke-width:1px;

    session0["<tt>Source session for module &lt;main></tt>"]
    class session0 nowrapClass;

    session0 --> call1

    call1["Call 1<br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>==(this@R|/Test|.R|/Test.something|, Null(null))</tt></pre>"]
    class call1 nowrapClass;
    class call1 callStyle;

    call1 --> candidate2

    candidate2["Candidate 1: <tt>FirSyntheticFunctionSymbol _synthetic/EQUALITY_CALL</tt><br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>fun EQUALITY_CALL(x: Any?, y: Any?): Boolean
</tt></pre>"]
    class candidate2 nowrapClass;
    class candidate2 candidateStyle;

    candidate2 --> stage3

    stage3["Resolution Stages > CheckArguments"]
    class stage3 nowrapClass;
    class stage3 stageStyle;
    constraint4["<tt>String? &lt;: Any?</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>Argument this|/Test|.R|/Test.something|</tt></pre></i>"]
    class constraint4 nowrapClass;
    stage3 ~~~ constraint4
    constraint5["<tt>Nothing? &lt;: Any?</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>Argument Null(null)</tt></pre></i>"]
    class constraint5 nowrapClass;
    stage3 ~~~ constraint5

    constraint4 ~~~ call6
    constraint5 ~~~ call6

    call6["Call 2<br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>IllegalStateException#(String(Something is not defined.))</tt></pre>"]
    class call6 nowrapClass;
    class call6 callStyle;

    call6 --> candidate7

    candidate7["Candidate 1: <tt>FirConstructorSymbol java/lang/IllegalStateException.IllegalStateException</tt><br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>constructor(p0: String!): {kotlin/IllegalStateException=} IllegalStateException</tt></pre>"]
    class candidate7 nowrapClass;
    class candidate7 candidateStyle;

    candidate7 --> stage8

    stage8["Resolution Stages > CheckArguments"]
    class stage8 nowrapClass;
    class stage8 stageStyle;
    constraint9["<tt>String &lt;: String!</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>Argument String(Something is not defined.)</tt></pre></i>"]
    class constraint9 nowrapClass;
    stage8 ~~~ constraint9

    constraint9 ~~~ candidate10

    candidate10["Candidate 2: <tt>FirConstructorSymbol java/lang/IllegalStateException.IllegalStateException</tt><br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>constructor(p0: Throwable!): {kotlin/IllegalStateException=} IllegalStateException</tt></pre>"]
    class candidate10 nowrapClass;
    class candidate10 candidateStyle;

    candidate10 --> stage11

    stage11["Resolution Stages > CheckArguments"]
    class stage11 nowrapClass;
    class stage11 stageStyle;
    constraint13["<tt>String &lt;: Throwable!</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>Argument String(Something is not defined.)</tt></pre></i>"]
    class constraint13 nowrapClass;
    stage11 ~~~ constraint13

    constraint13 ~~~ error12

    error12["<b>NewConstraintError: <tt>kotlin/String &lt;: kotlin/Throwable!</tt><b>"]
    class error12 nowrapClass;

    error12 ~~~ candidate14

    candidate14["Candidate 1: <tt>FirConstructorSymbol java/lang/IllegalStateException.IllegalStateException</tt><br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>constructor(p0: String!): {kotlin/IllegalStateException=} IllegalStateException</tt></pre>"]
    class candidate14 nowrapClass;
    class candidate14 candidateStyle;

    candidate14 --> stage15

    stage15["Continue Resolution Stages > CheckLambdaAgainstTypeVariableContradiction"]
    class stage15 nowrapClass;
    class stage15 stageStyle;
    constraint16["<tt>{IllegalStateException=} IllegalStateException &lt;: Throwable</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>ExpectedType for some call</tt></pre></i>"]
    class constraint16 nowrapClass;
    stage15 ~~~ constraint16

    constraint16 ~~~ call17

    call17["Call 3<br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>parse#(R|&lt;local>/data|)</tt></pre>"]
    class call17 nowrapClass;
    class call17 callStyle;

    call17 --> candidate18

    candidate18["Candidate 1: <tt>FirNamedFunctionSymbol /parse</tt><br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>fun &lt;T> parse(data: String): T</tt></pre>"]
    class candidate18 nowrapClass;
    class candidate18 candidateStyle;

    candidate18 --> stage19

    stage19["Resolution Stages > CreateFreshTypeVariableSubstitutorStage"]
    class stage19 nowrapClass;
    class stage19 stageStyle;

    stage19 ~~~ newVariable20

    newVariable20["New <tt>TypeVariable(T)</tt> for <tt>FirNamedFunctionSymbol /parse</tt>s parameter 0"]
    class newVariable20 nowrapClass;

    newVariable20 ~~~ stage21

    stage21["Resolution Stages > CheckArguments"]
    class stage21 nowrapClass;
    class stage21 stageStyle;
    constraint22["<tt>String &lt;: String</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>Argument R|&lt;local>/data|</tt></pre></i>"]
    class constraint22 nowrapClass;
    stage21 ~~~ constraint22

    constraint22 ~~~ stage23

    stage23["Resolution Stages > CheckLambdaAgainstTypeVariableContradiction"]
    class stage23 nowrapClass;
    class stage23 stageStyle;
    constraint24["<tt>TypeVariable(T) &lt;: dynamic</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>ExpectedType for some call</tt></pre></i>"]
    class constraint24 nowrapClass;
    stage23 ~~~ constraint24

    constraint24 ~~~ stage25

    stage25["Call Completion"]
    class stage25 nowrapClass;
    class stage25 stageStyle;

    stage25 ~~~ variableReadiness26

    variableReadiness26["Choose <tt>TypeVariable(T)</tt> with <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>FORBIDDEN</tt></pre>"]
    class variableReadiness26 nowrapClass;
    class variableReadiness26 readinessStyle;

    variableReadiness26 ~~~ call27

    call27["Call 4<br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>when () {
    ==(this@R|/Test|.R|/Test.something|, Null(null)) ->  {
        throw R|java/lang/IllegalStateException.IllegalStateException|(String(Something is not defined.))
    }
    else ->  {
        R?C|/parse|(R|&lt;local>/data|)
    }
}
</tt></pre>"]
    class call27 nowrapClass;
    class call27 callStyle;

    call27 --> candidate28

    candidate28["Candidate 1: <tt>FirSyntheticFunctionSymbol _synthetic/WHEN_CALL</tt><br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>fun &lt;K> WHEN_CALL(vararg branches: K): K
</tt></pre>"]
    class candidate28 nowrapClass;
    class candidate28 candidateStyle;

    candidate28 --> stage29

    stage29["Resolution Stages > CreateFreshTypeVariableSubstitutorStage"]
    class stage29 nowrapClass;
    class stage29 stageStyle;

    stage29 ~~~ newVariable30

    newVariable30["New <tt>TypeVariable(K)</tt> for <tt>FirSyntheticFunctionSymbol _synthetic/WHEN_CALL</tt>s parameter 0"]
    class newVariable30 nowrapClass;

    newVariable30 ~~~ stage31

    stage31["Resolution Stages > CheckArguments"]
    class stage31 nowrapClass;
    class stage31 stageStyle;
    constraint32["<tt>Nothing &lt;: TypeVariable(K)</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>Argument throw R|java/lang/IllegalStateException.IllegalStateException|(String(Something is not defined.))</tt></pre></i>"]
    class constraint32 nowrapClass;
    stage31 ~~~ constraint32
    constraint33["<tt>TypeVariable(T) &lt;: TypeVariable(K)</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>Argument R?C|/parse|(R|&lt;local>/data|)</tt></pre></i>"]
    class constraint33 nowrapClass;
    stage31 ~~~ constraint33

    constraint32 ~~~ stage34
    constraint33 ~~~ stage34

    stage34["Resolution Stages > CheckIncompatibleTypeVariableUpperBounds"]
    class stage34 nowrapClass;
    class stage34 stageStyle;
    constraint35["<tt>TypeVariable(K) == dynamic</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>ExpectedType for some call</tt></pre></i>"]
    class constraint35 nowrapClass;
    stage34 ~~~ constraint35
    constraint36["<tt>TypeVariable(T) &lt;: dynamic</tt>"]
    class constraint36 nowrapClass;
    constraint33 --> constraint36
    constraint35 --> constraint36

    constraint36 ~~~ stage37

    stage37["Call Completion"]
    class stage37 nowrapClass;
    class stage37 stageStyle;

    stage37 ~~~ variableReadiness38

    variableReadiness38["Choose <tt>TypeVariable(K)</tt> with <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>READY_FOR_FIXATION_UPPER</tt></pre>"]
    class variableReadiness38 nowrapClass;
    class variableReadiness38 readinessStyle;
    constraint40["<tt>TypeVariable(K) == dynamic</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>Fix variable K</tt></pre></i>"]
    class constraint40 nowrapClass;
    variableReadiness38 ~~~ constraint40

    constraint40 ~~~ variableReadiness39

    variableReadiness39["Choose <tt>TypeVariable(T)</tt> with <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>READY_FOR_FIXATION_UPPER</tt></pre>"]
    class variableReadiness39 nowrapClass;
    class variableReadiness39 readinessStyle;
    constraint41["<tt>TypeVariable(T) == dynamic</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>Fix variable T</tt></pre></i>"]
    class constraint41 nowrapClass;
    variableReadiness39 ~~~ constraint41

    constraint41 ~~~ call42

    call42["Call 5<br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>TODO#()</tt></pre>"]
    class call42 nowrapClass;
    class call42 callStyle;

    call42 --> candidate43

    candidate43["Candidate 1: <tt>FirNamedFunctionSymbol kotlin/TODO</tt><br><br><pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>@InlineOnly() fun TODO(): Nothing
</tt></pre>"]
    class candidate43 nowrapClass;
    class candidate43 candidateStyle;

    candidate43 --> stage44

    stage44["Continue Resolution Stages > CheckLambdaAgainstTypeVariableContradiction"]
    class stage44 nowrapClass;
    class stage44 stageStyle;
    constraint45["<tt>Nothing &lt;: T</tt><br><br><i><div style="display: inline-block;vertical-align: middle;">from</div> <pre style="display: inline-block;vertical-align: middle;text-align: left;margin: 0;"><tt>ExpectedType for some call</tt></pre></i>"]
    class constraint45 nowrapClass;
    stage44 ~~~ constraint45

    linkStyle 5 stroke:#990000
    linkStyle 6 stroke:#009999
    linkStyle 10 stroke:#4c9900
    linkStyle 13 stroke:#4c0099
    linkStyle 17 stroke:#994900
    linkStyle 23 stroke:#004f99
    linkStyle 25 stroke:#039900
    linkStyle 34 stroke:#950099
    linkStyle 35 stroke:#992400
    linkStyle 37 stroke:#992400
    linkStyle 38 stroke:#007499
    linkStyle 39 stroke:#279900
    linkStyle 42 stroke:#710099
    linkStyle 44 stroke:#996d00
    style constraint4 stroke:#990000;
    style constraint5 stroke:#009999;
    style constraint9 stroke:#4c9900;
    style constraint13 stroke:#4c0099;
    style constraint16 stroke:#994900;
    style constraint22 stroke:#004f99;
    style constraint24 stroke:#039900;
    style constraint32 stroke:#950099;
    style constraint33 stroke:#992400;
    style constraint35 stroke:#007499;
    style constraint36 stroke:#279900;
    style constraint40 stroke:#710099;
    style constraint41 stroke:#996d00;